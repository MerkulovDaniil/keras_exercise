

```python
from keras.models import Sequential
from keras.layers import Dense
import numpy

# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
```

    Using TensorFlow backend.



```python
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
```


```python
dataset[:5]
```




    array([[  6.00000000e+00,   1.48000000e+02,   7.20000000e+01,
              3.50000000e+01,   0.00000000e+00,   3.36000000e+01,
              6.27000000e-01,   5.00000000e+01,   1.00000000e+00],
           [  1.00000000e+00,   8.50000000e+01,   6.60000000e+01,
              2.90000000e+01,   0.00000000e+00,   2.66000000e+01,
              3.51000000e-01,   3.10000000e+01,   0.00000000e+00],
           [  8.00000000e+00,   1.83000000e+02,   6.40000000e+01,
              0.00000000e+00,   0.00000000e+00,   2.33000000e+01,
              6.72000000e-01,   3.20000000e+01,   1.00000000e+00],
           [  1.00000000e+00,   8.90000000e+01,   6.60000000e+01,
              2.30000000e+01,   9.40000000e+01,   2.81000000e+01,
              1.67000000e-01,   2.10000000e+01,   0.00000000e+00],
           [  0.00000000e+00,   1.37000000e+02,   4.00000000e+01,
              3.50000000e+01,   1.68000000e+02,   4.31000000e+01,
              2.28800000e+00,   3.30000000e+01,   1.00000000e+00]])




```python
X[:5]
```




    array([[  6.00000000e+00,   1.48000000e+02,   7.20000000e+01,
              3.50000000e+01,   0.00000000e+00,   3.36000000e+01,
              6.27000000e-01,   5.00000000e+01],
           [  1.00000000e+00,   8.50000000e+01,   6.60000000e+01,
              2.90000000e+01,   0.00000000e+00,   2.66000000e+01,
              3.51000000e-01,   3.10000000e+01],
           [  8.00000000e+00,   1.83000000e+02,   6.40000000e+01,
              0.00000000e+00,   0.00000000e+00,   2.33000000e+01,
              6.72000000e-01,   3.20000000e+01],
           [  1.00000000e+00,   8.90000000e+01,   6.60000000e+01,
              2.30000000e+01,   9.40000000e+01,   2.81000000e+01,
              1.67000000e-01,   2.10000000e+01],
           [  0.00000000e+00,   1.37000000e+02,   4.00000000e+01,
              3.50000000e+01,   1.68000000e+02,   4.31000000e+01,
              2.28800000e+00,   3.30000000e+01]])




```python
Y[:5]
```




    array([ 1.,  0.,  1.,  0.,  1.])




```python
# create model
model = Sequential()
model.add(Dense(12, input_dim=8, init='uniform', activation='relu'))
model.add(Dense(8, init='uniform', activation='relu'))
model.add(Dense(1, init='uniform', activation='sigmoid'))
```


```python
# Compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
```


```python
# Fit the model
model.fit(X, Y, nb_epoch=150, batch_size=10)
```

    Epoch 1/150
    768/768 [==============================] - 0s - loss: 0.6843 - acc: 0.6172     
    Epoch 2/150
    768/768 [==============================] - 0s - loss: 0.6649 - acc: 0.6510     
    Epoch 3/150
    768/768 [==============================] - 0s - loss: 0.6530 - acc: 0.6523     
    Epoch 4/150
    768/768 [==============================] - 0s - loss: 0.6424 - acc: 0.6563     
    Epoch 5/150
    768/768 [==============================] - 0s - loss: 0.6281 - acc: 0.6732     
    Epoch 6/150
    768/768 [==============================] - 0s - loss: 0.6182 - acc: 0.6758     
    Epoch 7/150
    768/768 [==============================] - 0s - loss: 0.6100 - acc: 0.6706     
    Epoch 8/150
    768/768 [==============================] - 0s - loss: 0.6025 - acc: 0.6888     
    Epoch 9/150
    768/768 [==============================] - 0s - loss: 0.5991 - acc: 0.6810     
    Epoch 10/150
    768/768 [==============================] - 0s - loss: 0.5920 - acc: 0.6901     
    Epoch 11/150
    768/768 [==============================] - 0s - loss: 0.5924 - acc: 0.6862     
    Epoch 12/150
    768/768 [==============================] - 0s - loss: 0.5901 - acc: 0.6979     
    Epoch 13/150
    768/768 [==============================] - 0s - loss: 0.5875 - acc: 0.6888     
    Epoch 14/150
    768/768 [==============================] - 0s - loss: 0.5813 - acc: 0.6979     
    Epoch 15/150
    768/768 [==============================] - 0s - loss: 0.5780 - acc: 0.6979     
    Epoch 16/150
    768/768 [==============================] - 0s - loss: 0.5737 - acc: 0.7044     
    Epoch 17/150
    768/768 [==============================] - 0s - loss: 0.5876 - acc: 0.6992     
    Epoch 18/150
    768/768 [==============================] - 0s - loss: 0.5831 - acc: 0.6927     
    Epoch 19/150
    768/768 [==============================] - 0s - loss: 0.5812 - acc: 0.6979     
    Epoch 20/150
    768/768 [==============================] - 0s - loss: 0.5787 - acc: 0.6940     
    Epoch 21/150
    768/768 [==============================] - 0s - loss: 0.5768 - acc: 0.7083     
    Epoch 22/150
    768/768 [==============================] - 0s - loss: 0.5754 - acc: 0.6966     
    Epoch 23/150
    768/768 [==============================] - 0s - loss: 0.5736 - acc: 0.6979     
    Epoch 24/150
    768/768 [==============================] - 0s - loss: 0.5737 - acc: 0.6992     
    Epoch 25/150
    768/768 [==============================] - 0s - loss: 0.5734 - acc: 0.6862     
    Epoch 26/150
    768/768 [==============================] - 0s - loss: 0.5684 - acc: 0.7044     
    Epoch 27/150
    768/768 [==============================] - 0s - loss: 0.5666 - acc: 0.7109     
    Epoch 28/150
    768/768 [==============================] - 0s - loss: 0.5745 - acc: 0.7031     
    Epoch 29/150
    768/768 [==============================] - 0s - loss: 0.5711 - acc: 0.7083     
    Epoch 30/150
    768/768 [==============================] - 0s - loss: 0.5675 - acc: 0.7096     
    Epoch 31/150
    768/768 [==============================] - 0s - loss: 0.5718 - acc: 0.7057     
    Epoch 32/150
    768/768 [==============================] - 0s - loss: 0.5655 - acc: 0.7005     
    Epoch 33/150
    768/768 [==============================] - 0s - loss: 0.5641 - acc: 0.7174     
    Epoch 34/150
    768/768 [==============================] - 0s - loss: 0.5601 - acc: 0.7187     
    Epoch 35/150
    768/768 [==============================] - 0s - loss: 0.5619 - acc: 0.7148     
    Epoch 36/150
    768/768 [==============================] - 0s - loss: 0.5606 - acc: 0.7096     
    Epoch 37/150
    768/768 [==============================] - 0s - loss: 0.5624 - acc: 0.7057     
    Epoch 38/150
    768/768 [==============================] - 0s - loss: 0.5592 - acc: 0.7109     
    Epoch 39/150
    768/768 [==============================] - 0s - loss: 0.5606 - acc: 0.7135     
    Epoch 40/150
    768/768 [==============================] - 0s - loss: 0.5590 - acc: 0.7201     
    Epoch 41/150
    768/768 [==============================] - 0s - loss: 0.5576 - acc: 0.7266     
    Epoch 42/150
    768/768 [==============================] - 0s - loss: 0.5578 - acc: 0.7148     
    Epoch 43/150
    768/768 [==============================] - 0s - loss: 0.5606 - acc: 0.7279     
    Epoch 44/150
    768/768 [==============================] - 0s - loss: 0.5505 - acc: 0.7383     
    Epoch 45/150
    768/768 [==============================] - 0s - loss: 0.5580 - acc: 0.7096     
    Epoch 46/150
    768/768 [==============================] - 0s - loss: 0.5536 - acc: 0.7201     
    Epoch 47/150
    768/768 [==============================] - 0s - loss: 0.5488 - acc: 0.7383     
    Epoch 48/150
    768/768 [==============================] - 0s - loss: 0.5505 - acc: 0.7240     
    Epoch 49/150
    768/768 [==============================] - 0s - loss: 0.5480 - acc: 0.7370     
    Epoch 50/150
    768/768 [==============================] - 0s - loss: 0.5452 - acc: 0.7396     
    Epoch 51/150
    768/768 [==============================] - 0s - loss: 0.5471 - acc: 0.7266     
    Epoch 52/150
    768/768 [==============================] - 0s - loss: 0.5434 - acc: 0.7305     
    Epoch 53/150
    768/768 [==============================] - 0s - loss: 0.5442 - acc: 0.7318     
    Epoch 54/150
    768/768 [==============================] - 0s - loss: 0.5451 - acc: 0.7305     
    Epoch 55/150
    768/768 [==============================] - 0s - loss: 0.5395 - acc: 0.7318     
    Epoch 56/150
    768/768 [==============================] - 0s - loss: 0.5444 - acc: 0.7370     
    Epoch 57/150
    768/768 [==============================] - 0s - loss: 0.5413 - acc: 0.7318     
    Epoch 58/150
    768/768 [==============================] - 0s - loss: 0.5374 - acc: 0.7396     
    Epoch 59/150
    768/768 [==============================] - 0s - loss: 0.5359 - acc: 0.7474     
    Epoch 60/150
    768/768 [==============================] - 0s - loss: 0.5313 - acc: 0.7383     
    Epoch 61/150
    768/768 [==============================] - 0s - loss: 0.5344 - acc: 0.7383     
    Epoch 62/150
    768/768 [==============================] - 0s - loss: 0.5298 - acc: 0.7487     
    Epoch 63/150
    768/768 [==============================] - 0s - loss: 0.5307 - acc: 0.7370     
    Epoch 64/150
    768/768 [==============================] - 0s - loss: 0.5328 - acc: 0.7370     
    Epoch 65/150
    768/768 [==============================] - 0s - loss: 0.5242 - acc: 0.7474     
    Epoch 66/150
    768/768 [==============================] - 0s - loss: 0.5186 - acc: 0.7578     
    Epoch 67/150
    768/768 [==============================] - 0s - loss: 0.5290 - acc: 0.7435     
    Epoch 68/150
    768/768 [==============================] - 0s - loss: 0.5245 - acc: 0.7474     
    Epoch 69/150
    768/768 [==============================] - 0s - loss: 0.5258 - acc: 0.7448     
    Epoch 70/150
    768/768 [==============================] - 0s - loss: 0.5211 - acc: 0.7617     
    Epoch 71/150
    768/768 [==============================] - 0s - loss: 0.5214 - acc: 0.7526     
    Epoch 72/150
    768/768 [==============================] - 0s - loss: 0.5179 - acc: 0.7383     
    Epoch 73/150
    768/768 [==============================] - 0s - loss: 0.5222 - acc: 0.7487     
    Epoch 74/150
    768/768 [==============================] - 0s - loss: 0.5200 - acc: 0.7474     
    Epoch 75/150
    768/768 [==============================] - 0s - loss: 0.5210 - acc: 0.7552     
    Epoch 76/150
    768/768 [==============================] - 0s - loss: 0.5162 - acc: 0.7513     
    Epoch 77/150
    768/768 [==============================] - 0s - loss: 0.5187 - acc: 0.7461     
    Epoch 78/150
    768/768 [==============================] - 0s - loss: 0.5141 - acc: 0.7474     
    Epoch 79/150
    768/768 [==============================] - 0s - loss: 0.5115 - acc: 0.7487     
    Epoch 80/150
    768/768 [==============================] - 0s - loss: 0.5124 - acc: 0.7552     
    Epoch 81/150
    768/768 [==============================] - 0s - loss: 0.5117 - acc: 0.7526     
    Epoch 82/150
    768/768 [==============================] - 0s - loss: 0.5172 - acc: 0.7448     
    Epoch 83/150
    768/768 [==============================] - 0s - loss: 0.5119 - acc: 0.7539     
    Epoch 84/150
    768/768 [==============================] - 0s - loss: 0.5109 - acc: 0.7331     
    Epoch 85/150
    768/768 [==============================] - 0s - loss: 0.5054 - acc: 0.7552     
    Epoch 86/150
    768/768 [==============================] - 0s - loss: 0.5069 - acc: 0.7435     
    Epoch 87/150
    768/768 [==============================] - 0s - loss: 0.5114 - acc: 0.7526     
    Epoch 88/150
    768/768 [==============================] - 0s - loss: 0.5099 - acc: 0.7630     
    Epoch 89/150
    768/768 [==============================] - 0s - loss: 0.5009 - acc: 0.7552     
    Epoch 90/150
    768/768 [==============================] - 0s - loss: 0.5085 - acc: 0.7474     
    Epoch 91/150
    768/768 [==============================] - 0s - loss: 0.5008 - acc: 0.7643     
    Epoch 92/150
    768/768 [==============================] - 0s - loss: 0.5010 - acc: 0.7539     
    Epoch 93/150
    768/768 [==============================] - 0s - loss: 0.5047 - acc: 0.7500     
    Epoch 94/150
    768/768 [==============================] - 0s - loss: 0.5043 - acc: 0.7578     
    Epoch 95/150
    768/768 [==============================] - 0s - loss: 0.4978 - acc: 0.7578     
    Epoch 96/150
    768/768 [==============================] - 0s - loss: 0.5023 - acc: 0.7604     
    Epoch 97/150
    768/768 [==============================] - 0s - loss: 0.5036 - acc: 0.7448     
    Epoch 98/150
    768/768 [==============================] - 0s - loss: 0.4975 - acc: 0.7604     
    Epoch 99/150
    768/768 [==============================] - 0s - loss: 0.4950 - acc: 0.7669     
    Epoch 100/150
    768/768 [==============================] - 0s - loss: 0.4953 - acc: 0.7669     
    Epoch 101/150
    768/768 [==============================] - 0s - loss: 0.4939 - acc: 0.7656     
    Epoch 102/150
    768/768 [==============================] - 0s - loss: 0.4903 - acc: 0.7552     
    Epoch 103/150
    768/768 [==============================] - 0s - loss: 0.4928 - acc: 0.7656     
    Epoch 104/150
    768/768 [==============================] - 0s - loss: 0.4977 - acc: 0.7513     
    Epoch 105/150
    768/768 [==============================] - 0s - loss: 0.4905 - acc: 0.7747     
    Epoch 106/150
    768/768 [==============================] - 0s - loss: 0.4894 - acc: 0.7552     
    Epoch 107/150
    768/768 [==============================] - 0s - loss: 0.4952 - acc: 0.7526     
    Epoch 108/150
    768/768 [==============================] - 0s - loss: 0.4930 - acc: 0.7591     
    Epoch 109/150
    768/768 [==============================] - 0s - loss: 0.4848 - acc: 0.7734     
    Epoch 110/150
    768/768 [==============================] - 0s - loss: 0.4902 - acc: 0.7682     
    Epoch 111/150
    768/768 [==============================] - 0s - loss: 0.4823 - acc: 0.7721     
    Epoch 112/150
    768/768 [==============================] - 0s - loss: 0.4892 - acc: 0.7578     
    Epoch 113/150
    768/768 [==============================] - 0s - loss: 0.4839 - acc: 0.7682     
    Epoch 114/150
    768/768 [==============================] - 0s - loss: 0.4866 - acc: 0.7643     
    Epoch 115/150
    768/768 [==============================] - 0s - loss: 0.4834 - acc: 0.7565     
    Epoch 116/150
    768/768 [==============================] - 0s - loss: 0.4813 - acc: 0.7682     
    Epoch 117/150
    768/768 [==============================] - 0s - loss: 0.4846 - acc: 0.7721     
    Epoch 118/150
    768/768 [==============================] - 0s - loss: 0.4835 - acc: 0.7643     
    Epoch 119/150
    768/768 [==============================] - 0s - loss: 0.4872 - acc: 0.7643     
    Epoch 120/150
    768/768 [==============================] - 0s - loss: 0.4762 - acc: 0.7656     
    Epoch 121/150
    768/768 [==============================] - 0s - loss: 0.4793 - acc: 0.7656     
    Epoch 122/150
    768/768 [==============================] - 0s - loss: 0.4767 - acc: 0.7760     
    Epoch 123/150
    768/768 [==============================] - 0s - loss: 0.4875 - acc: 0.7656     
    Epoch 124/150
    768/768 [==============================] - 0s - loss: 0.4729 - acc: 0.7734     
    Epoch 125/150
    768/768 [==============================] - 0s - loss: 0.4822 - acc: 0.7695     
    Epoch 126/150
    768/768 [==============================] - 0s - loss: 0.4737 - acc: 0.7695     
    Epoch 127/150
    768/768 [==============================] - 0s - loss: 0.4742 - acc: 0.7708     
    Epoch 128/150
    768/768 [==============================] - 0s - loss: 0.4782 - acc: 0.7786     
    Epoch 129/150
    768/768 [==============================] - 0s - loss: 0.4736 - acc: 0.7721     
    Epoch 130/150
    768/768 [==============================] - 0s - loss: 0.4711 - acc: 0.7786     
    Epoch 131/150
    768/768 [==============================] - 0s - loss: 0.4764 - acc: 0.7734     
    Epoch 132/150
    768/768 [==============================] - 0s - loss: 0.4694 - acc: 0.7786     
    Epoch 133/150
    768/768 [==============================] - 0s - loss: 0.4708 - acc: 0.7773     
    Epoch 134/150
    768/768 [==============================] - 0s - loss: 0.4689 - acc: 0.7747     
    Epoch 135/150
    768/768 [==============================] - 0s - loss: 0.4744 - acc: 0.7669     
    Epoch 136/150
    768/768 [==============================] - 0s - loss: 0.4711 - acc: 0.7799     
    Epoch 137/150
    768/768 [==============================] - 0s - loss: 0.4671 - acc: 0.7773     
    Epoch 138/150
    768/768 [==============================] - 0s - loss: 0.4662 - acc: 0.7695     
    Epoch 139/150
    768/768 [==============================] - 0s - loss: 0.4678 - acc: 0.7695     
    Epoch 140/150
    768/768 [==============================] - 0s - loss: 0.4693 - acc: 0.7799     
    Epoch 141/150
    768/768 [==============================] - 0s - loss: 0.4636 - acc: 0.7760     
    Epoch 142/150
    768/768 [==============================] - 0s - loss: 0.4747 - acc: 0.7747     
    Epoch 143/150
    768/768 [==============================] - 0s - loss: 0.4712 - acc: 0.7826     
    Epoch 144/150
    768/768 [==============================] - 0s - loss: 0.4695 - acc: 0.7721     
    Epoch 145/150
    768/768 [==============================] - 0s - loss: 0.4615 - acc: 0.7734     
    Epoch 146/150
    768/768 [==============================] - 0s - loss: 0.4646 - acc: 0.7643     
    Epoch 147/150
    768/768 [==============================] - 0s - loss: 0.4657 - acc: 0.7734     
    Epoch 148/150
    768/768 [==============================] - 0s - loss: 0.4588 - acc: 0.7799     
    Epoch 149/150
    768/768 [==============================] - 0s - loss: 0.4650 - acc: 0.7826     
    Epoch 150/150
    768/768 [==============================] - 0s - loss: 0.4625 - acc: 0.7865     





    <keras.callbacks.History at 0x115175950>




```python
# evaluate the model
scores = model.evaluate(X, Y)
print("\n%s: %.2f%%" % (model.metrics_names[1], scores[1]*100))
scores
```

    768/768 [==============================] - 0s     
    
    acc: 77.73%





    [0.45839844644069672, 0.77734375]




```python
probabilities = model.predict(X)
predictions = [float(round(x)) for x in probabilities]
accuracy = numpy.mean(predictions == Y)
print("Prediction Accuracy: %.2f%%" % (accuracy*100))
```

    Prediction Accuracy: 77.73%



```python

```
